# SYNOPSIS

soot的调用方式：

`java javaOptions soot.Main [ sootOption* ] classname*`

# DESCRIPTION

这个文档主要在介绍`sootOption`

关于soot选项的描述有关于三种class：`argument classes, application classes, and library classes`

`Argument class`指的是明确指定给Soot的类

- Argument classes are those you specify explicitly to Soot. When you use Soot's command line interface, argument classes are those classes which are either listed explicitly on the command line or found in a directory specified with the `-process-dir` option. When you use the Soot's Eclipse plug-in, argument classes are those which you selected before starting Soot from the Navigator popup menu, or all classes in the current project if you started Soot from the Project menu.

`application class`是被分析，转换的类

`library class`是应用类直接或间接引用的类，但它不被转化和输出。

**三者不是完全对立的关系**

**All argument classes are necessarily application classes.**

All argument classes are necessarily application classes. When Soot is not in "application mode'', argument classes are the only application classes; other classes referenced from the argument classes become library classes.

When Soot is in application mode, every class referenced from the argument classes, directly or indirectly, is also an application class, unless its package name indicates that it is part of the standard Java runtime system.



`--app`可以指定应用模式选项。



文档在后面对比了几种涉及上面三个类的情况，不过没看出来有什么用。**有空实践一下**。

# OPTIONS

options共9类。**<u>本版本的重点在于apk repacking，所以先跳过一些，只看相关的和重点</u>**

## General Options



## Input Options

input options里涉及了apk, jimple, dex

```
-process-multiple-dex        Process all DEX files found in APK.
-search-dex-in-archives      Also includes Jar and Zip files when searching for DEX files under the 
                             provided classpath.
-android-api-version version Force Soot to use version as the API version when readin in APK or DEX
                             files.
-src-prec format             Sets source precedence to format files.
```

## Output Options

output options里涉及了dex

```
-f format                    Set output format for Soot.
-java-version version        Force Java version of bytecode generated by Soot.
-hierarchy-dirs              Generate class hierarchy directories for Jimple/Shimple.
-dump-body phaseName         Dump the internal representation of each method before and after phase 
phaseName.
-dump-cfg phaseName          Dump the internal representation of each CFG constructed during phase 
phaseName.
-show-exception-dests        Include exception destination edges as well as CFG edges in dumped CFGs.
```

## Processing Options

```
-throw-analysis arg
-check-init-ta arg
```

## Application Mode Options

```
-i pkg                       Include classes in pkg as application classes
-x pkg                       Exclude classes in pkg from application classes
-include-all                 Set default excluded packages to empty list
-dynamic-class class         Note that class may be loaded dynamically
-dynamic-dir dir             Mark all classes in dir as potentially dynamic
-dynamic-package pkg         Marks classes in pkg as potentially dynamic
```

## Input Attribute Options

## Output Attribute Options

## Annotation Options

```
-annot-purity                Emit purity attributes
-annot-nullpointer           Emit null pointer attributes
-annot-arraybounds           Emit array bounds check attributes
-annot-side-effect           Emit side-effect attributes
-annot-fieldrw               Emit field read/write attributes
```
## Miscellaneous Options

# PHASES AND PHASE OPTIONS

Soot's execution is divided into a number of phases. For example, `JimpleBody`s are built by a phase called `jb`, which is itself comprised of subphases, such as the aggregation of local variables (`jb.a`).

Phase options provide a way for you to change the behaviour of a phase from the Soot command-line. 

They take the form `-p` *phase*. *name* *option*:*value*. For instance, to instruct Soot to use original names in Jimple, we would invoke Soot like this:

```
java soot.Main foo -p jb use-original-names:true
```

*<u>看起来很像函数参数的感觉，估计实际上也确实是某函数的参数</u>*

Multiple option-value pairs may be specified in a single `-p` option separated by commas. For example,

```
java soot.Main foo -p cg.spark verbose:true,on-fly-cg:true
```

*<u>需要多个option-value pair的时候就用逗号分隔</u>*

参数类型有五种，没什么可注意的。

All phases and subphases accept the option `enabled`, which must be `true` for the phase or subphase to execute. To save you some typing, the pseudo-options `on` and `off` are equivalent to `enabled:true` and `enabled:false`, respectively. In addition, specifying any options for a phase automatically enables that phase.

#### Adding your own subphases

***<u>这里介绍了自定义的方法</u>***

Within Soot, each phase is implemented by a `Pack`. The `Pack` is a collection of transformers, each corresponding to a subphase of the phase implemented by the `Pack`. When the `Pack` is called, it executes each of its transformers in order.

Soot transformers are usually instances of classes that extend `BodyTransformer` or `SceneTransformer`. <u>In either case, the transformer class must override the `internalTransform` method, providing an implementation which carries out some transformation on the code being analyzed.</u>

To add a transformer to some `Pack` without modifying Soot itself, create your own class which changes the contents of the `Pack`s to meet your requirements and then calls `soot.Main`.

**<u>The remainder of this document describes the transformations belonging to Soot's various `Pack`s and their corresponding phase options.</u>**



































