意在整理这本书上有用的知识点

# C1

## 2 PEP8风格指南

- <u>`from XXX import *`不会引入以下划线开头的对象</u>。

- <u>借助上一条，可以通过下划线来使全局变量仅在模块内使用</u>。

- <u>模块应该用\_\_all\_\_来标记公用的方法</u>。

- 使用`''.startswith() and ''.endswith() `而不是`foo[:3] == 'bar'`来判断。

- 对象类型比较应始终使用isinstance()而不是直接比较类型。

- `try...finally`结构里不建议在`finally`里return，这样会错过`finally`中的异常。

## 3 了解bytes、str与unicode的区别

把编解码放在最外围去做，程序核心部分使用str(python2中的unicode)

在Python 3里面,如果通过内置的open函数获取了文件句柄，该句柄默认会采用UTF-8编码格式来操作文件。

而在Python 2中， 文件操作的默认编码格式则是二进制形式。

在P3中，用w参数向文件写随机数字是不行的了，需要wb参数。

## 5

赋值列表可以直接`b = a[:]`

**生成反转序列可以使用`y = x[::-1]`**

## 6 在单次切片操作内，不要同时指定start、end和stride

出于可读性考虑

## 12 不要在for和while循环后面写else块

由于此处`else`的特殊语义，容易造成误会。

## 13 合理利用try/except/else/finally结构中的每个代码块

1. `finally`

   如果既要将异常向上传播，又要在异常发生时执行清理工作，那就可以使用`try/finally`结构。这种结构有一项常见的用途，就是确保程序能够可靠地关闭文件句柄(<u>还有另外一种写法，参见本书第43条</u>)。

   我理解的finally是使try和except后面接上同一段代码，但是和直接写在异常处理外相比，还是有点差别的。如果是不上报异常仅是处理的情况，try和except中被运行的代码包括<u>try中出错前的代码，异常处理中的代码，finally部分代码，写在外面的后续处理代码</u>。如果处理后上报异常，处理的代码有<u>try中出错前的代码，异常处理中的代码，finally部分代码</u>。可见把必要的后续处理写在finally是明智的，**主要针对的是发生异常后必要的后续代码**。当然没有异常时也会执行

2. `else`

   如果没有异常，就执行else，增加了可读性。可以把没有异常时要执行的语句放在这里。

3. `else`的顺序先于`finally`



## 14 尽量用异常来表示特殊情况，而不要返回None

用异常，不要用None和错误代码

## 15 了解如何在闭包里使用外围作用域中的变量

在表达式中引用变量时,Python解释器将按如下顺序遍历各作用域，以解析该引用:

1. 当前函数的作用域。

2. 任何外围作用域(例如，包含当前函数的其他函数)。

3. 包含当前代码的那个模块的作用域(也叫全局作用域，global scope)。

4. 内置作用域(也就是包含len及str等函数的那个作用域)。

如果上面这些地方都没有定义过名称相符的变量，那就抛出NameError异常。

`globol`可以修改外面的变量，被标注的变量即被视为外部变量

`nonlocal`声明的变量不是局部变量,也不是全局变量,而是外部嵌套函数内的变量。不过这个关键字不能延伸到模块级别。

【**还是要看书记录，写的不详细**】

## 17 在参数上面迭代时，要多加小心

参数是迭代器时，如果元素意外用完了，触发了Stopiteration会很不方便，

**更好的办法是是新编一种实现迭代器协议(iterator protocol)的容器类。**实现`__iter__`

## 18 用数量可变的位置参数减少视觉杂讯

```python
favorites = [7, 33, 99]
log('Favorite colors1', *favorites)
==========
Favorite colors: 7, 33, 99
```

## 21 用只能以关键字形式指定的参数来确保代码明晰

部分参数**必须以关键字的形式提供，而不能按位置提供**

如将函数定义为

```python
def safe_division_c(number, divisor, *,
                    ignore_overflow=False,
                    ignore_zero_divi sion=False):

```

这种方法使调用者不得不使用关键字调用，这条建议更倾向于开发者的角度。



















